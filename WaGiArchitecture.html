﻿<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>WaGi</title>
    <link rel="stylesheet" href="WaGi_files/scholarly.css">
    <link rel="stylesheet" href="WaGi_files/prism-coy.css">
    <script src="WaGi_files/prism.js" defer="defer"></script>
</head>
<body prefix="schema: http://schema.org/ xsd: http://www.w3.org/2001/XMLSchema# sa: https://ns.science.ai/">
    <header>
        <p class="title">WaGi</p>
        <p class="subtitle">by CLIW-CCA team</p>
    </header>
    <article id="what" typeof="schema:ScholarlyArticle" resource="#">
        <h1>WaGi - Architecture</h1>
        <section>
            <ol>
                <li property="schema:author" typeof="sa:ContributorRole">
                    <a property="schema:author" href="https://github.com/cristian1997" typeof="schema:Person">
                        <span property="schema:givenName">Cristian</span>
                        <span property="schema:familyName">Vintur</span>
                    </a>
                </li>
                <li property="schema:contributor" typeof="sa:ContributorRole">
                    <a property="schema:contributor" href="https://github.com/loghinalexandru" typeof="schema:Person">
                        <span property="schema:givenName">Cristi</span>
                        <span property="schema:familyName">Cosulianu</span>
                    </a>
                </li>
                <li property="schema:contributor" typeof="sa:ContributorRole">
                    <a property="schema:contributor" href="https://github.com/cristi-cosulianu" typeof="schema:Person">
                        <span property="schema:givenName">Alexandru</span>
                        <span property="schema:familyName">Loghin</span>
                    </a>
                </li>
            </ol>
        </section>

        <section typeof="sa:Abstract" id="abstract">
            <h2>Abstract</h2>
            <p>
                WaGi is a "shooter" game that can be played o web. Entities that will be
                "killed" are "dificult" questions posted on specific webpages like StackExchange.
                The accumulated score ,after collecting positive votes granted by others, can be
                saved localy or shared on social media.
            </p>
        </section>
        <section typeof="sa:MaterialsAndMethods" id="motivation">
            <h2>Motivation</h2>
            <p>
                Nova days is hard to deliver education using formal methods because we face
                big changes in the way we live. Technology is evolving faster and faster and
                is reaching almost to everyone and whatever we do requires a smartphone or a
                PC. Over the years, education has changed very little and is starting to lose
                front against technology. So here we come with WaGi, an educational web application
                that is a game where you can learn new things and to help others to learn.
            </p>

        </section>
        <section typeof="sa:GitArchitecture" id="gitarchitecture">
            <h2>Github Architecture</h2>
            <p>
                We will use the following architecture for working on github.
            </p>
            <figure typeof="sa:Image">
                <img src="WaGi_files/arhitectura-git-explanations.png" width="880" height="655">
                <figcaption>
                    Each branch for different purposes: master for Continuous
                    Integration, feature branches if needed, gh-pages for this report,
                    docker for deployment and Dockerfiles.
                </figcaption>
            </figure>
        </section>

        <section typeof="sa:Architecture" id="architecture">
            <h2>Architecture</h2>
            <p>
                WaGi will minimally implement the following architecture:
            </p>
            <figure typeof="sa:Image">
                <img src="WaGi_files/app-architecture-simplified.png" width="880" height="655">
                <figcaption>
                    Made with <a href="https://www.draw.io/">Diagrams Editor</a>.
                </figcaption>
            </figure>
            <p>
                Our server will be made using the open source Node.js runtime
                environment plus Express framework. We made this choice because of
                scalability and the relatively easy learning curve involved.
                Because of our architectural design choice, our app will run on a single
                thread and
                will allow thousands of concurrent connections. In matter of
                view engine, we chose <a href="http://www.embeddedjs.com/">ejs</a> (also called embedded js) for simplicity.
            </p>
            <p>
                The data will be stored two fold, using both a classic
                relational database (Oracle 11g) and a NoSQL database (MongoDB). The
                data that will be visualized by our app
                will most probably be stored using Oracle. The connection
                between the database and our server will be provided by oracledb node
                module (<a href="https://www.npmjs.com/package/oracledb">link on npm</a>).
                To help us design this database side of our app, we will make use of
                SQL Developer.
                So basically after a user connects to our server and makes a
                request for
                some data, our server will make a query to the database and
                then receive a response. This will form a transaction (we would prefer
                not keeping the database connection open all the time).
                Login details for our registered users will be stored  using
                MongoDB, connected to our server by Mongoose.
            </p>

            <p>
                We will aim though for this kind of architecture (even if we implement just a part of it):
            </p>
            <figure typeof="sa:Image">
                <img src="WaGi_files/app-architecture.png" width="880" height="655">
                <figcaption>
                    Made with <a href="https://www.draw.io/">Diagrams Editor</a>.
                </figcaption>
            </figure>
            <p>
                For our more advanced approach we want use Docker to wrap
                around our app in order to automate deployment and provide containers
                for the different types of applications used. Hence,
                we wish to use a container for the Node.js server (which may
                use PM2 or cluster for making several workers of the master Node server,
                to take advantage of the multicore nature of the hardware) and
                containers for the two types of databases used by our app.
                For optimizing resource utilization, reducing latency and for
                ensuring a fault-tolerant configuration we will use nginx as a HTTP load
                balancer &amp; proxy and Redis as a Web cache (<a href="https://en.wikipedia.org/wiki/Web_cache">in theory</a>, or <a href="https://www.nginx.com/resources/wiki/modules/redis/">practical</a>).
            </p>
            <h4>Modelling the database(s)</h4>
            <p>
            </p><h5>SQL</h5>
            <figure typeof="sa:Image">
                <img src="WaGi_files/CoDr-DatabaseSQL.png" width="880" height="655">
                <figcaption>
                    Made with <a href="https://www.draw.io/">Diagrams Editor</a>.
                </figcaption>
            </figure>
            <p>
                This will be the database for storing the json, after parsing it with java (you can find notes on this process <a href="https://github.com/xR86/tw-project/tree/master/_java-json-parser">here</a>)
            </p>
            <p>
                We will take advantage of the SQL joining, so we will break
                the json processed data into 2 tables: Persons and Tasks.
            </p>

            <h5>NoSQL</h5>
            <figure typeof="sa:Image">
                <img src="WaGi_files/CoDr-DatabaseNoSQL.png" width="880" height="655">
                <figcaption>
                    Made with <a href="https://www.draw.io/">Diagrams Editor</a>.
                </figcaption>
            </figure>
            <p>
                On the other side, we will use NoSQL for login, through
                Mongoose (for schema validation) and Passport (for the login
                specifically).
            </p>
            <p>
                We start from the presumption that login through NoSQL will
                be faster than login through Oracle. We will check this soon.
            </p>


            <p></p>
            <h4>REST API</h4>
            <p>
                Momentarily, our API will expose a route like <code>/users</code>,
                where users data from the json (the FreeCodeCamp json, that is) will be
                returned and offer the possibility of specifying the format in which
                the data is returned when <b>GET</b> is called with the querystring (eg: <code>/users?format=xml</code> or <code>/users?format=json</code> ; json will be default).
            </p>
            <p>
                Filtering options will also include: filtering by task name (eg: <code>/users?taskName="Waypoint: Learn how Free Code Camp Works"</code>), completion date (full date, or combinations of year, month, day; eg: <code>/users?completionMonth=08</code>) or by existing solution (eg: <code>/users?solutionExists=true</code>).
            </p>
            <p>
                We will probably impose a limit on the data returned for IO/network/security reasons.
            </p>
        </section>

        <section typeof="sa:PageArchitecture" id="pagearchitecture">
            <h2>Page Architecture</h2>
            <p>
                We will use the following architecture for structuring our ejs templates.
            </p>
            <figure typeof="sa:Image">
                <img src="WaGi_files/CoDr-arhitecturaPagini.png" width="880" height="655">
                <figcaption>
                    Each node represents a page (or view or template). All pages inherit from the main template. 2<sup>nd</sup> degree inheritance is relevant only for the <code>Contact</code> page.
                </figcaption>
            </figure>
            <p><code>Template</code> will store the navigation bar and the footer. Every page will have this. The next level of inheritance is neccessary for <code>Contact</code>, since we want it to extend the <code>About</code> page, so it isn't only a form (and we don't want to concatenate, because from an UX perspective they need to be separated). </p>
            <p>
                We also have some doubts on the architecture when it comes to the <b>activity log</b> and <b>template logic</b>. We don't know yet how we would record and save user actions, or how we will display them, so this is a <b>pending feature</b>
                (we may, or may not implement it). The other issue we are thinking
                about is that of logging in: should we check, each time we render a
                view, if the user is logged in, and display some elements (the template
                logic approach), or should we have a separate base template for logged
                in users from the not logged in users ?
            </p>
            <h2>Additional notes and prototype will be found on the repo's <a href="https://github.com/cristian1997/CLIW-wagi">README</a></h2>
        </section>

        <section typeof="sa:Acknowledgements" id="acknowledgements">
            <h2>Acknowledgements</h2>
            <p>
                WaGi would like to thank <a href="http://scholarlyhtml.org/">Scholarly HTML</a> for offering a template for making this academic report.
            </p>
            <p>
                WaGi would also extend its thanks to all the people that have made <a href="http://scholarlyhtml.org/">Scholarly HTML</a> possible.
            </p>
            <p>
                If we somehow forgot you in this list and you are too gracious to complain, we thank you
                all the same.
            </p>
        </section>
        <section typeof="sa:Conclusion" id="conclusion">
            <h2>Conclusion</h2>
            <p>
                WaGi is currently a work in progress and is open to change. If you have
                feedback, simply
                <a href="https://github.com/cristian1997/CLIW-wagi/issues">open an issue</a> on
                GitHub, or <a href="https://github.com/cristian1997/CLIW-wagi">
                    make a pull
                    request
                </a>.
            </p>
        </section>
    </article>
    <footer>
        <p>
            <a href="https://github.com/cristian1997/CLIW-wagi">@CLIW-CCA Team</a>
        </p>
    </footer>


</body>
</html>